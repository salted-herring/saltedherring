define(["./core","./var/document","./var/rnotwhite","./var/slice","./data/var/dataPriv","./core/init","./selector"],function(e,t,n,r,i){function a(){return!0}function f(){return!1}function l(){try{return t.activeElement}catch(e){}}function c(t,n,r,i,s,o){var u,a;if(typeof n=="object"){typeof r!="string"&&(i=i||r,r=undefined);for(a in n)c(t,a,r,i,n[a],o);return t}i==null&&s==null?(s=r,i=r=undefined):s==null&&(typeof r=="string"?(s=i,i=undefined):(s=i,i=r,r=undefined));if(s===!1)s=f;else if(!s)return this;return o===1&&(u=s,s=function(t){return e().off(t),u.apply(this,arguments)},s.guid=u.guid||(u.guid=e.guid++)),t.each(function(){e.event.add(this,n,s,i,r)})}var s=/^key/,o=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,u=/^([^.]*)(?:\.(.+)|)/;return e.event={global:{},add:function(t,r,s,o,a){var f,l,c,h,p,d,v,m,g,y,b,w=i.get(t);if(!w)return;s.handler&&(f=s,s=f.handler,a=f.selector),s.guid||(s.guid=e.guid++),(h=w.events)||(h=w.events={}),(l=w.handle)||(l=w.handle=function(n){return typeof e!="undefined"&&e.event.triggered!==n.type?e.event.dispatch.apply(t,arguments):undefined}),r=(r||"").match(n)||[""],p=r.length;while(p--){c=u.exec(r[p])||[],g=b=c[1],y=(c[2]||"").split(".").sort();if(!g)continue;v=e.event.special[g]||{},g=(a?v.delegateType:v.bindType)||g,v=e.event.special[g]||{},d=e.extend({type:g,origType:b,data:o,handler:s,guid:s.guid,selector:a,needsContext:a&&e.expr.match.needsContext.test(a),namespace:y.join(".")},f),(m=h[g])||(m=h[g]=[],m.delegateCount=0,(!v.setup||v.setup.call(t,o,y,l)===!1)&&t.addEventListener&&t.addEventListener(g,l)),v.add&&(v.add.call(t,d),d.handler.guid||(d.handler.guid=s.guid)),a?m.splice(m.delegateCount++,0,d):m.push(d),e.event.global[g]=!0}},remove:function(t,r,s,o,a){var f,l,c,h,p,d,v,m,g,y,b,w=i.hasData(t)&&i.get(t);if(!w||!(h=w.events))return;r=(r||"").match(n)||[""],p=r.length;while(p--){c=u.exec(r[p])||[],g=b=c[1],y=(c[2]||"").split(".").sort();if(!g){for(g in h)e.event.remove(t,g+r[p],s,o,!0);continue}v=e.event.special[g]||{},g=(o?v.delegateType:v.bindType)||g,m=h[g]||[],c=c[2]&&new RegExp("(^|\\.)"+y.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=f=m.length;while(f--)d=m[f],(a||b===d.origType)&&(!s||s.guid===d.guid)&&(!c||c.test(d.namespace))&&(!o||o===d.selector||o==="**"&&d.selector)&&(m.splice(f,1),d.selector&&m.delegateCount--,v.remove&&v.remove.call(t,d));l&&!m.length&&((!v.teardown||v.teardown.call(t,y,w.handle)===!1)&&e.removeEvent(t,g,w.handle),delete h[g])}e.isEmptyObject(h)&&i.remove(t,"handle events")},dispatch:function(t){t=e.event.fix(t);var n,s,o,u,a,f=[],l=r.call(arguments),c=(i.get(this,"events")||{})[t.type]||[],h=e.event.special[t.type]||{};l[0]=t,t.delegateTarget=this;if(h.preDispatch&&h.preDispatch.call(this,t)===!1)return;f=e.event.handlers.call(this,t,c),n=0;while((u=f[n++])&&!t.isPropagationStopped()){t.currentTarget=u.elem,s=0;while((a=u.handlers[s++])&&!t.isImmediatePropagationStopped())if(!t.rnamespace||t.rnamespace.test(a.namespace))t.handleObj=a,t.data=a.data,o=((e.event.special[a.origType]||{}).handle||a.handler).apply(u.elem,l),o!==undefined&&(t.result=o)===!1&&(t.preventDefault(),t.stopPropagation())}return h.postDispatch&&h.postDispatch.call(this,t),t.result},handlers:function(t,n){var r,i,s,o,u=[],a=n.delegateCount,f=t.target;if(a&&f.nodeType&&(t.type!=="click"||isNaN(t.button)||t.button<1))for(;f!==this;f=f.parentNode||this)if(f.nodeType===1&&(f.disabled!==!0||t.type!=="click")){i=[];for(r=0;r<a;r++)o=n[r],s=o.selector+" ",i[s]===undefined&&(i[s]=o.needsContext?e(s,this).index(f)>-1:e.find(s,this,null,[f]).length),i[s]&&i.push(o);i.length&&u.push({elem:f,handlers:i})}return a<n.length&&u.push({elem:this,handlers:n.slice(a)}),u},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,s,o=n.button;return e.pageX==null&&n.clientX!=null&&(r=e.target.ownerDocument||t,i=r.documentElement,s=r.body,e.pageX=n.clientX+(i&&i.scrollLeft||s&&s.scrollLeft||0)-(i&&i.clientLeft||s&&s.clientLeft||0),e.pageY=n.clientY+(i&&i.scrollTop||s&&s.scrollTop||0)-(i&&i.clientTop||s&&s.clientTop||0)),!e.which&&o!==undefined&&(e.which=o&1?1:o&2?3:o&4?2:0),e}},fix:function(n){if(n[e.expando])return n;var r,i,u,a=n.type,f=n,l=this.fixHooks[a];l||(this.fixHooks[a]=l=o.test(a)?this.mouseHooks:s.test(a)?this.keyHooks:{}),u=l.props?this.props.concat(l.props):this.props,n=new e.Event(f),r=u.length;while(r--)i=u[r],n[i]=f[i];return n.target||(n.target=t),n.target.nodeType===3&&(n.target=n.target.parentNode),l.filter?l.filter(n,f):n},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==l()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===l()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&e.nodeName(this,"input"))return this.click(),!1},_default:function(t){return e.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},e.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},e.Event=function(t,n){if(!(this instanceof e.Event))return new e.Event(t,n);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||t.defaultPrevented===undefined&&t.returnValue===!1?a:f):this.type=t,n&&e.extend(this,n),this.timeStamp=t&&t.timeStamp||e.now(),this[e.expando]=!0},e.Event.prototype={constructor:e.Event,isDefaultPrevented:f,isPropagationStopped:f,isImmediatePropagationStopped:f,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=a,e&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=a,e&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=a,e&&e.stopImmediatePropagation(),this.stopPropagation()}},e.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,n){e.event.special[t]={delegateType:n,bindType:n,handle:function(t){var r,i=this,s=t.relatedTarget,o=t.handleObj;if(!s||s!==i&&!e.contains(i,s))t.type=o.origType,r=o.handler.apply(this,arguments),t.type=n;return r}}}),e.fn.extend({on:function(e,t,n,r){return c(this,e,t,n,r)},one:function(e,t,n,r){return c(this,e,t,n,r,1)},off:function(t,n,r){var i,s;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,e(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if(typeof t=="object"){for(s in t)this.off(s,n,t[s]);return this}if(n===!1||typeof n=="function")r=n,n=undefined;return r===!1&&(r=f),this.each(function(){e.event.remove(this,t,r,n)})}}),e});