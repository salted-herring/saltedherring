define(["../core"],function(e){var t=function(n,r,i,s,o,u,a){var f=0,l=n.length,c=i==null;if(e.type(i)==="object"){o=!0;for(f in i)t(n,r,f,i[f],!0,u,a)}else if(s!==undefined){o=!0,e.isFunction(s)||(a=!0),c&&(a?(r.call(n,s),r=null):(c=r,r=function(t,n,r){return c.call(e(t),r)}));if(r)for(;f<l;f++)r(n[f],i,a?s:s.call(n[f],f,r(n[f],i)))}return o?n:c?r.call(n):l?r(n[0],i):u};return t});