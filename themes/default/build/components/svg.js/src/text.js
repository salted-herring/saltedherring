var _styleAttr="size family weight stretch variant style".split(" ");SVG.Text=function(){this.constructor.call(this,SVG.create("text")),this.styles={"font-size":16,"font-family":"Helvetica, Arial, sans-serif","text-anchor":"start"},this._leading=new SVG.Number("1.2em"),this._rebuild=!0},SVG.Text.prototype=new SVG.Shape,SVG.extend(SVG.Text,{x:function(e,t){return e==null?t?this.attr("x"):this.bbox().x:(t||(t=this.style("text-anchor"),e=t=="start"?e:t=="end"?e+this.bbox().width:e+this.bbox().width/2),this.textPath||this.lines.each(function(){this.newLined&&this.x(e)}),this.attr("x",e))},cx:function(e,t){return e==null?this.bbox().cx:this.x(e-this.bbox().width/2)},cy:function(e,t){return e==null?this.bbox().cy:this.y(t?e:e-this.bbox().height/2)},move:function(e,t,n){return this.x(e,n).y(t)},center:function(e,t,n){return this.cx(e,n).cy(t,n)},text:function(e){if(e==null)return this.content;this.clear();if(typeof e=="function")this._rebuild=!1,e(this);else{this._rebuild=!0,e=SVG.regex.isBlank.test(e)?"text":e;var t,n,r=e.split("\n");for(t=0,n=r.length;t<n;t++)this.tspan(r[t]).newLine();this.rebuild()}return this},tspan:function(e){var t=this.textPath?this.textPath.node:this.node,n=(new SVG.TSpan).text(e),r=this.style();return t.appendChild(n.node),this.lines.add(n),SVG.regex.isBlank.test(r)||n.style(r),this.content+=e,n.parent=this,n},size:function(e){return this.attr("font-size",e)},leading:function(e){return e==null?this._leading:(e=new SVG.Number(e),this._leading=e,this.lines.each(function(){this.newLined&&this.attr("dy",e)}),this)},rebuild:function(){var e=this;return this._rebuild&&this.lines.attr({x:this.attr("x"),dy:this._leading,style:this.style()}),this},clear:function(){var e=this.textPath?this.textPath.node:this.node;while(e.hasChildNodes())e.removeChild(e.lastChild);return delete this.lines,this.lines=new SVG.Set,this.content="",this}}),SVG.extend(SVG.Container,{text:function(e){return this.put(new SVG.Text).text(e)}}),SVG.TSpan=function(){this.constructor.call(this,SVG.create("tspan"))},SVG.TSpan.prototype=new SVG.Shape,SVG.extend(SVG.TSpan,{text:function(e){return this.node.appendChild(document.createTextNode(e)),this},dx:function(e){return this.attr("dx",e)},dy:function(e){return this.attr("dy",e)},newLine:function(){return this.newLined=!0,this.parent.content+="\n",this.dy(this.parent._leading),this.attr("x",this.parent.x())}});